<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yusufkhon Corporation - Auth</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --accent: #06b6d4;
            --bg-dark: #070c1c;
            --card-bg: #111827;
            --input-bg: #161e2d;
            --text-gray: #e2e8f0;
            --muted: #94a3b8;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: "Poppins", sans-serif; }
        
        body { 
            background: #070c1c;
            color: var(--text-gray); 
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .auth-card {
            background: var(--card-bg);
            padding: 40px 30px;
            border-radius: 35px;
            width: 100%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 25px 50px rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.05);
        }

        .logo-area { margin-bottom: 25px; }
        .logo-area h2 { font-size: 24px; color: white; letter-spacing: 2px; text-transform: uppercase; }
        .logo-area span { font-size: 10px; color: var(--accent); letter-spacing: 4px; display: block; margin-top: 5px; }

        .tabs { display: flex; background: #0b1120; padding: 6px; border-radius: 18px; margin-bottom: 30px; }
        .tab-btn { flex: 1; padding: 14px; border: none; background: transparent; color: var(--muted); cursor: pointer; font-weight: 600; border-radius: 14px; transition: 0.3s; }
        .tab-btn.active { background: var(--accent); color: #070c1c; }

        .auth-form { display: none; flex-direction: column; gap: 18px; text-align: left; }
        .auth-form.active { display: flex; }

        .input-group { display: flex; flex-direction: column; gap: 8px; }
        .input-group label { font-size: 13px; color: var(--muted); margin-left: 5px; }
        .input-group input { width: 100%; padding: 16px 20px; background: var(--input-bg); border: 1px solid #2d3748; border-radius: 15px; color: white; font-size: 15px; outline: none; transition: 0.3s; }
        .input-group input:focus { border-color: var(--accent); }

        .btn-submit { width: 100%; background: var(--accent); color: #070c1c; border: none; padding: 18px; border-radius: 18px; font-weight: 700; font-size: 15px; cursor: pointer; margin-top: 10px; text-transform: uppercase; }
        
        /* OTP maydoni uchun animatsiya */
        #otp-area { display: none; border: 1px dashed var(--accent); padding: 15px; border-radius: 15px; margin-bottom: 10px; }
        
        .back-home { margin-top: 25px; display: block; color: var(--muted); text-decoration: none; font-size: 13px; text-align: center; }
    </style>
</head>
<body>

    <div class="auth-card">
        <div class="logo-area">
            <h2>YUSUFKHON</h2>
            <span>C O R P O R A T I O N</span>
        </div>

        <div class="tabs">
            <button class="tab-btn active" id="tab-login-text" onclick="toggleTab('login')">Kirish</button>
            <button class="tab-btn" id="tab-signup-text" onclick="toggleTab('signup')">Ro'yxatdan o'tish</button>
        </div>

        <form id="login-form" class="auth-form active">
            <div class="input-group">
                <label>Email yoki Login</label>
                <input type="text" id="login-user" placeholder="example@mail.com" required>
            </div>
            <div class="input-group">
                <label>Parol</label>
                <input type="password" id="login-pass" placeholder="••••••••" required>
            </div>
            <button type="submit" class="btn-submit">KIRISH</button>
        </form>

        <form id="signup-form" class="auth-form">
            <div id="signup-fields">
                <div class="input-group">
                    <label>To'liq ism</label>
                    <input type="text" id="reg-name" placeholder="John Doe" required>
                </div>
                <div class="input-group">
                    <label>Email</label>
                    <input type="email" id="reg-email" placeholder="mail@example.com" required>
                </div>
                <div class="input-group">
                    <label>Yangi parol</label>
                    <input type="password" id="reg-pass" placeholder="••••••••" required>
                </div>
            </div>

            <div id="otp-area">
                <div class="input-group">
                    <label style="color: var(--accent);">Emailga yuborilgan 6 xonali kod:</label>
                    <input type="text" id="otp-code" placeholder="000000" maxlength="6">
                </div>
            </div>

            <button type="submit" class="btn-submit" id="main-btn">RO'YXATDAN O'TISH</button>
        </form>

        <a href="#" class="back-home">← Bosh sahifaga qaytish</a>
    </div>

    <script>
       // 1. O'zgaruvchilarni e'lon qilish
let isOtpSent = false;
const serverUrl = "https://yusufkhon.onrender.com"; // Render linkini shu yerga qo'ying

// 2. Sahifa yuklanganda holatni tekshirish
window.onload = function() {
    renderUI();
};

// 3. UI-ni foydalanuvchi holatiga qarab o'zgartirish
function renderUI() {
    const isLoggedIn = localStorage.getItem('userToken'); // Kirganlik belgisi
    const loginTab = document.getElementById('tab-login-text');
    const signupTab = document.getElementById('tab-signup-text');
    const loginForm = document.getElementById('login-form');
    const signupForm = document.getElementById('signup-form');
    const cardBody = document.querySelector('.auth-card');

    if (isLoggedIn) {
        // Tizimga kirgan bo'lsa: Tugmalarni almashtiramiz
        document.querySelector('.tabs').innerHTML = `
            <button class="tab-btn active" style="background: #ef4444; color: white; width: 100%;" onclick="logout()">LOG OUT</button>
        `;
        loginForm.style.display = 'none';
        signupForm.style.display = 'none';
        
        // Markazga xush kelibsiz xabari
        if (!document.getElementById('welcome-text')) {
            const welcome = document.createElement('div');
            welcome.id = 'welcome-text';
            welcome.innerHTML = `
                <h3 style="margin-top: 20px; color: var(--accent);">Xush kelibsiz!</h3>
                <p style="font-size: 13px; color: var(--muted);">Siz tizimga muvaffaqiyatli kirdingiz.</p>
            `;
            cardBody.appendChild(welcome);
        }
    }
}

// 4. Chiqish funksiyasi
function logout() {
    localStorage.removeItem('userToken'); // Ma'lumotni o'chirish
    alert("Tizimdan chiqdingiz!");
    location.reload(); // Sahifani yangilash
}

// 5. Ro'yxatdan o'tish (OTP tasdiqlangandan keyingi qism)
async function handleSignupSuccess() {
    // Bu yerda server "OK" javobini bergandan keyin ishlaydi
    localStorage.setItem('userToken', 'true'); // Brauzerda saqlab qolish
    renderUI();
}

// Avvalgi signup-form event listeneriga handleSignupSuccess() ni qo'shishni unutmang
document.getElementById('signup-form').addEventListener('submit', async (e) => {
    e.preventDefault();
    const btn = document.getElementById('main-btn');
    
    if (!isOtpSent) {
        // OTP yuborish kodi...
        // ... (oldingi yozgan kodimiz)
    } else {
        // KODNI TASDIQLASH QISMI
        const code = document.getElementById('otp-code').value;
        const res = await fetch(`${serverUrl}/verify-otp`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ /* ma'lumotlar */ })
        });

        if (res.ok) {
            handleSignupSuccess(); // Muvaffaqiyatli bo'lsa UI-ni o'zgartiramiz
        } else {
            alert("Kod xato!");
        }
    }
});;
        
    </script>

    <script></script>
</body>
</html>